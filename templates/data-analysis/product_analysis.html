<div class="container">
    <h1>Amazon Product Analysis
        <br>产品分析
    </h1>
    <form id="analysis-form" action="{{ url_for('dataset.product_analysis.submit_product_analysis') }}" method="POST" enctype="multipart/form-data">
        <label for="project_name">项目名称:</label>
        <select name="project_name" id="project_name" required>
            <option value="">请选择项目</option>
            {% for project in projects %}
            <option value="{{ project }}">{{ project }}</option>
            {% endfor %}
        </select>

        <label for="report_date_range">报表日期范围:</label>
        <div class="date-range-container">
            <input type="date" name="report_start_date" id="report_start_date" required>
            <span>至</span>
            <input type="date" name="report_end_date" id="report_end_date" required>
            <button type="button" id="last-week-btn">上周</button>
        </div>

        <!-- 拖拽文件上传区域 -->
        <div class="drop-area" id="drop-area">
            <h3>拖拽文件到此处</h3>
            <p>或点击选择文件</p>
            <p class="file-types">支持文件类型：.csv, .xlsx, .txt</p>
            <p class="upload-hint">可以分次上传，每次上传1个或多个文件</p>
            <input type="file" id="file-input" name="files" multiple accept=".csv,.xlsx,.txt" style="display: none;">
        </div>

        <!-- 文件列表显示 -->
        <div class="file-list" id="file-list">
            <div class="file-item empty" id="file-business_report">
                <span>业务报告：等待上传（.csv格式）
                    <a href="{{ url_for('help.business_report') }}" target="_blank" class="help-icon">?</a>
                </span>
                <span class="upload-progress">未上传</span>
            </div>
            <div class="file-item empty" id="file-payment_report">
                <span>付款报告：等待上传（.csv格式）
                    <a href="{{ url_for('help.payment_report') }}" target="_blank" class="help-icon">?</a>
                </span>
                <span class="upload-progress">未上传</span>
            </div>
            <div class="file-item empty" id="file-ad_report">
                <span>广告报表：等待上传（.xlsx格式）
                    <a href="{{ url_for('help.ad_product_report') }}" target="_blank" class="help-icon">?</a>
                </span>
                <span class="upload-progress">未上传</span>
            </div>
            <div class="file-item empty" id="file-fba_report">
                <span>FBA库存：等待上传（.txt格式，内容包含"snapshot-date"）
                    <a href="{{ url_for('help.fba_inventory_help') }}" target="_blank" class="help-icon">?</a>
                </span>
                <span class="upload-progress">未上传（可选）</span>
            </div>
        </div>

        <!-- 隐藏的文件路径输入框 -->
        <div class="hidden-inputs">
            <input type="hidden" name="business_report_path" id="business_report_path">
            <input type="hidden" name="payment_report_path" id="payment_report_path">
            <input type="hidden" name="ad_report_path" id="ad_report_path">
            <input type="hidden" name="fba_report_path" id="fba_report_path">
        </div>

        <button type="submit" id="submit-btn" disabled>生成产品分析</button>
    </form>
</div>