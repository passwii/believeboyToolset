<div class="container" id="product-analysis-yumai-page">
    <h1>商品分析（优麦云）</h1>
    <form id="yumai-analysis-form" action="/yumai-analysis/submit" method="POST">
        <div class="form-section">
            <label for="project_name">项目名称*</label>
            <select name="project_name" id="project_name" required>
                <option value="">请选择项目</option>
                {% for project in projects %}
                <option value="{{ project }}">{{ project }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-section">
            <label for="report_date_range">报表日期范围*</label>
            <div class="date-range-container">
                <input type="date" name="report_start_date" id="report_start_date" required>
                <span>至</span>
                <input type="date" name="report_end_date" id="report_end_date" required>
                <button type="button" id="yesterday-btn" class="btn-quick">昨天</button>
                <button type="button" id="last-week-btn" class="btn-quick">上周</button>
            </div>
        </div>

        <!-- Unified File Upload -->
        <div class="file-upload-container">
            <label for="file-input" class="file-input-label">
                <i class="fas fa-upload"></i>
                <span>点击选择文件</span>
            </label>
            <input type="file" id="file-input" name="files" multiple accept=".xlsx,.txt" class="file-input-hidden">
            <p class="file-types">支持文件类型：.xlsx, .txt。可一次性选择多个文件，系统将自动识别。</p>
        </div>

        <!-- File Status List -->
        <div class="file-list" id="file-list">
            <div class="file-item empty" id="file-yumai_report">
                <span>优麦云报表: 等待上传 (.xlsx格式)</span>
                <span class="upload-progress">未上传</span>
            </div>
            <div class="file-item empty" id="file-inventory_report">
                <span>FBA库存: 等待上传 (.txt格式, 可选)</span>
                <span class="upload-progress">未上传</span>
            </div>
        </div>

        <!-- Hidden inputs for file paths -->
        <div class="hidden-inputs">
            <input type="hidden" name="yumai_report_path" id="yumai_report_path">
            <input type="hidden" name="inventory_report_path" id="inventory_report_path">
        </div>

        <button type="submit" id="submit-btn" class="submit-btn" disabled>生成商品分析</button>
    </form>
</div>

<style>
    /* Styles adapted from product_analysis.html for consistency */
    #product-analysis-yumai-page {
        max-width: 900px; margin: 20px auto; padding: 2rem;
        background: var(--bg-primary, #111); border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }
    #product-analysis-yumai-page h1 { text-align: center; margin-bottom: 2rem; }
    .form-section { margin-bottom: 1.5rem; }
    label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-secondary, #aaa); }
    select, input[type="date"] {
        width: 100%; padding: 12px; background: var(--bg-secondary, #222);
        border: 1px solid var(--border-color, #444); border-radius: 8px; color: var(--text-primary, #fff);
    }
    .date-range-container { display: flex; align-items: center; gap: 10px; }

    .file-upload-container {
        border: 2px dashed var(--border-color, #444); border-radius: 12px;
        padding: 40px 20px; text-align: center; margin: 2rem 0;
        background: var(--bg-secondary, #1a1a1a); transition: all 0.3s ease;
    }
    .file-upload-container.dragover {
        border-color: var(--neon-blue, #00d4ff);
        background: rgba(0, 212, 255, 0.05);
    }
    .file-input-label { cursor: pointer; font-size: 1.1em; color: var(--text-secondary, #aaa); }
    .file-input-label i { margin-right: 10px; color: var(--neon-blue, #00d4ff); }
    .file-input-hidden { display: none; }
    .file-types { color: var(--text-secondary, #888); font-size: 0.9em; margin-top: 15px; }

    .file-list { margin-top: 1rem; }
    .file-item {
        padding: 12px 15px; margin: 8px 0; background: var(--bg-tertiary, #2a2a2a);
        border-radius: 8px; display: flex; justify-content: space-between; align-items: center;
        border-left: 4px solid var(--border-color, #444); transition: all 0.3s ease;
    }
    .file-item.empty { border-left-color: var(--border-color, #444); }
    .file-item.uploading { border-left-color: var(--warning-color, #ffaa00); }
    .file-item.uploaded { border-left-color: var(--success-color, #00ff88); }
    .file-item.error { border-left-color: var(--error-color, #ff006e); }
    .upload-progress { font-size: 0.9em; color: var(--text-secondary, #888); }

    .hidden-inputs { display: none; }
    .submit-btn {
        width: 100%; padding: 15px; font-size: 1.1em; font-weight: bold;
        background: var(--neon-blue, #00d4ff); color: #000; border: none;
        border-radius: 8px; cursor: pointer; transition: all 0.3s ease;
    }
    .submit-btn:hover { background: #fff; box-shadow: 0 0 15px var(--neon-blue); }
    .submit-btn:disabled { background: var(--border-color, #444); color: var(--text-secondary, #888); cursor: not-allowed; }
</style>
